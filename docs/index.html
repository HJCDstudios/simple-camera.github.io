<html>
<head>
<meta name="viewport" content="user-scalable=no,initial-scale=1,maximum-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="A simple camera with custom stuff by HJCD studios">
<meta name="keywords" content="HJCD studios,Camera,hjcd studios">
<meta name="author" content="HJCD studios">
<title>HJCD studios | Simple Camera</title>
</head>
<style type="text/css">
i {
font-size: 20px;
}
#prev {
  display: none;
}
input[type="button"] {
  color: rgb(0,150,255);
  border-color: rgb(0,150,255);
  border-radius: rgb(0,150,255);
  background-color: white;
  font-size: 20px;
}
</style>
</head>
<script type="text/javascript">
var options = {
video:null,
audio:null
}
//width and height
var w = 300,
  h = 0;
var Video1 = document.getElementById("camera_view");
const canvas = document.getElementById("img");
//start video
function start_video() {
navigator.mediaDevices.getUserMedia(options).then(function(stream){
Video1.srcObject = stream;
Video1.width = w;
Video1.height = h;
}).catch((error) => {
document.getElementById("errors").innerHTML = error;
});
}
function to_boolean(bol) {
if (bol == "true") {
return true;
}
else if (bol == "false") {
return false;
} else {
return bol;
}
}
function load_data() {
var mic = localStorage.getItem("mic");
var vid = localStorage.getItem("vid");

//check if mic has already been configured
if (mic != null) {
options.audio = to_boolean(mic);
document.getElementById("mic_enable").checked = to_boolean(mic);
} else {
document.getElementById("mic_enable").checked = true;
options.audio = true;
}
//check if video has already been configured
if (vid != null) {
options.video = to_boolean(vid);
document.getElementById("vid_enable1").checked = to_boolean(vid);
} else {
document.getElementById("vid_enable1").checked = true;
options.video = true;
}
start_video();
}
//configure mic
function mic(enable) {
localStorage.setItem("mic",enable);
load_data();
}
//configure vid
function vid(enable) {
localStorage.setItem("vid",enable);
load_data();
}
//callback for taking pictures
function TakePicture() {
  if (w && h) {
    var con = canvas.getContext("2d");
    canvas.width = w;
    canvas.height = h;
    con.drawImage(Video1,0,0,w,h);
    canvas.toDataURL('image/png');
    home.style.display = "none";
    prev.style.display = "block";
  } else {
  }
}
function back() {
  home.style.display = "block";
  prev.style.display = "none";
}
</script>
<body onLoad="load_data();">
<div id="home">
<video id="camera_view" autoplay></video>
<hr>
<i class="fa fa-microphone"> Mic <input type="checkbox" id="mic_enable" onClick="mic(this.checked);"></i>
<br>
<br>
<i class="fa fa-camera"> Video <input type="checkbox" id="vid_enable1" onClick="vid(this.checked);"></i>
<br>
<input type="button" value="Take Picture" onClick="TakePicture();">
<hr>
<div id="errors">
</div>
</div>
<div id="prev">
<canvas id="img"></canvas>
<input type="button" value="Back" onClick="back()">
</div>
</body>
</html>
